<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Online Bookstore Inventory</title>
    <meta charset="UTF-8"/>
    <style>
        body { font-family: Arial, sans-serif; background: #fafafa; margin: 40px; }
        h1 { color: #333; }
        table { border-collapse: collapse; width: 80%; margin-top: 20px; }
        th, td { padding: 10px; border: 1px solid #ccc; text-align: left; }
        th { background-color: #f2f2f2; }
    </style>
</head>
<body>
    <div>
        <div th:if="${isLoggedIn}">
            <span>Welcome, <strong th:text="${user.username}"></strong></span>
            <span th:if="${isAdmin}" class="badge badge-admin">ADMIN</span>
            <span th:unless="${isAdmin}" class="badge">CUSTOMER</span>
            <a th:href="@{/logout}">Logout</a>
        </div>
        <div th:unless="${isLoggedIn}">
            <a th:href="@{/login}">Login</a> | 
            <a th:href="@{/register}">Register</a>
        </div>
    </div>
    
    <div class="clear"></div>
    
    <h1>Bookstore Inventory</h1>

    <div th:if="${isAdmin}" class="admin-section">
        <h2>Add a New Book</h2>
        <form th:action="@{/addBook}" th:object="${newBook}" method="post">
            <label>Name: <input type="text" th:field="*{bookTitle}" required/></label>
            <label>Genre: <input type="text" th:field="*{bookGenre}" required /></label>
            <label>Price: <input type="text" th:field="*{bookPrice}" required /></label>
            <label>ISBN: <input type="text" th:field="*{bookISBN}" required /></label>
            <button type="submit">Add Book</button>
        </form>
    </div>

    <!-- Info boxes for non-admin users -->
    <div th:unless="${isLoggedIn}" class="info-box">
        Browse our collection below. <a th:href="@{/login}">Login</a> to purchase books!
    </div>

    <div th:if="${isLoggedIn and !isAdmin}" class="info-box">
        Browse our collection below. Contact an administrator to add new books.
    </div>

    <table>
        <thead>
            <tr>
                <th>Name</th>
                <th>Genre</th>
                <th>Price</th>
                <th>ISBN</th>
                <th th:if="${isAdmin}">Actions</th>
            </tr>
        </thead>
        <tbody>
            <tr th:if="${books.isEmpty()}">
                <td th:colspan="${isAdmin ? 5 : 4}" style="text-align: center;">
                    No books available yet.
                </td>
            </tr>
            <tr th:each="book : ${books}">
                <td th:text="${book.bookTitle}"></td>
                <td th:text="${book.bookGenre}"></td>
                <td th:text="${book.bookPrice}"></td>
                <td th:text="${book.bookISBN}"></td>
                <td th:if="${isAdmin}">
                    <form th:action="@{/removeBook/{id}(id=${book.id})}" method="post" style="display:inline">
                        <button type="submit">Remove</button>
                    </form>
                </td>
            </tr>
        </tbody>
    </table>
</body>
</html>
